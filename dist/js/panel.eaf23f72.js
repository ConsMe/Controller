(function(t){function e(e){for(var i,l,c=e[0],o=e[1],_=e[2],d=0,u=[];d<c.length;d++)l=c[d],Object.prototype.hasOwnProperty.call(n,l)&&n[l]&&u.push(n[l][0]),n[l]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);r&&r(e);while(u.length)u.shift()();return s.push.apply(s,_||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],i=!0,c=1;c<a.length;c++){var o=a[c];0!==n[o]&&(i=!1)}i&&(s.splice(e--,1),t=l(l.s=a[0]))}return t}var i={},n={panel:0},s=[];function l(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=t,l.c=i,l.d=function(t,e,a){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)l.d(a,i,function(e){return t[e]}.bind(null,i));return a},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var _=0;_<c.length;_++)e(c[_]);var r=o;s.push([2,"chunk-vendors","chunk-common"]),a()})({"00f8":function(t,e,a){"use strict";a("d12c")},2:function(t,e,a){t.exports=a("b703")},b703:function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),n=a("e37d"),s=a("a65d"),l=a.n(s),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("left-side-bar"),a("header-comp"),a("panel")],1)},o=[],_=(a("10cc"),a("5a2e"),a("a725"),a("0a28")),r=a("0418"),d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("main",{staticClass:"panel"},[i("div",{staticClass:"panel__title title"},[t._v("Панель управления")]),i("nav",{staticClass:"panel__nav nav"},[i("div",{staticClass:"nav__btt"},[i("div",{staticClass:"nav__name nav__btt_active nav__name_1",on:{click:function(e){return t.home(1,e)}}},[t._v(" Выходы ")]),i("div",{staticClass:"nav__select"},[i("div",{staticClass:"nav__option nav__option_top",on:{click:function(e){return t.show_table(2,e)}}},[t._v(" Дискретные выходы ")]),i("div",{staticClass:"nav__option nav__option_bott",on:{click:function(e){return t.show_table(1,e)}}},[t._v(" Аналоговые выходы ")]),i("div",{staticClass:"nav__option nav__option_bott",on:{click:function(e){return t.show_table(4,e)}}},[t._v(" ШИМ выходы ")])])]),i("div",{staticClass:"nav__btt nav__btt_2",staticStyle:{display:"none"}},[i("div",{staticClass:"nav__name nav__name_2",on:{click:function(e){return t.home(2,e)}}},[t._v(" Устройства ")]),i("div",{staticClass:"nav__select"},[i("div",{staticClass:"nav__option nav__option_top nav__option_bott",on:{click:function(e){return t.show_table(3,e)}}},[t._v(" Наименование ")])])])]),i("div",{staticClass:"panel__table panel__table_1 panel__table_active"},[i("div",{staticClass:"panel__flex panel__flex_1 table"},[i("div",{staticClass:"table__name"},[t._v("Дискретные выходы")]),i("div",{staticClass:"table__table table__table_2"},[t._m(0),i("div",{staticClass:"table__overflow1",attrs:{id:"table_bin"}},t._l(t.states.obin,(function(e,a){return i("div",{key:""+e.device+a,staticClass:"table__row table__row_padd"},[i("div",{staticClass:"table__colum"},[t._v(t._s(e.device))]),i("div",{staticClass:"table__colum"},[t._v(t._s(e.label))]),i("div",{staticClass:"table__colum"},[i("div",{staticClass:"center"},[i("input",{staticClass:"cdx",staticStyle:{display:"none"},attrs:{type:"checkbox",id:""+e.device+a},domProps:{checked:!!e.value}}),i("label",{staticClass:"toggle",attrs:{for:""+e.device+a},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),t.setObin(e.device,e.index,e.value)}}},[i("span")])])])])})),0)])]),i("div",{staticClass:"panel__flex panel__flex_2 table"},[i("div",{staticClass:"table__name"},[t._v("Аналоговые выходы")]),i("div",{staticClass:"table__table table__table_1"},[t._m(1),i("div",{staticClass:"table__overflow1",attrs:{id:"table_dac"}},t._l(t.states.odac,(function(e,n){return i("div",{key:""+e.device+n,staticClass:"table__row table__row_padd"},[i("div",{staticClass:"table__colum"},[t._v(t._s(e.device))]),i("div",{staticClass:"table__colum"},[t._v(t._s(e.label))]),i("div",{staticClass:"table__colum table__colum_right"},[i("div",{staticClass:"table__edit edit"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"s.value"}],staticClass:"edit__input",attrs:{type:"text",name:"name"},domProps:{value:e.value},on:{focus:function(a){return t.setActiveField(e.device,n,"odac")},blur:t.resetActiveField,keypress:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.changeValue(e.device,e.index,"odac",a)},input:function(a){a.target.composing||t.$set(e,"value",a.target.value)}}}),i("div",{staticClass:"edit__block",on:{click:function(a){return t.changeValue(e.device,e.index,"odac",a)}}},[i("img",{attrs:{src:a("f584")}})])])])])})),0)])]),i("div",{staticClass:"panel__flex panel__flex_2 table"},[i("div",{staticClass:"table__name"},[t._v("ШИМ выходы")]),i("div",{staticClass:"table__table table__table_4"},[t._m(2),i("div",{staticClass:"table__overflow1",attrs:{id:"table_dac"}},t._l(t.states.opwm,(function(e,n){return i("div",{key:""+e.device+n,staticClass:"table__row table__row_padd"},[i("div",{staticClass:"table__colum"},[t._v(t._s(e.device))]),i("div",{staticClass:"table__colum"},[t._v(t._s(e.label))]),i("div",{staticClass:"table__colum table__colum_right"},[i("div",{staticClass:"table__edit edit"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"s.value"}],staticClass:"edit__input",attrs:{type:"text",name:"name"},domProps:{value:e.value},on:{focus:function(a){return t.setActiveField(e.device,n,"opwm")},blur:t.resetActiveField,keypress:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.changeValue(e.device,n,"opwm",a)},input:function(a){a.target.composing||t.$set(e,"value",a.target.value)}}}),i("div",{staticClass:"edit__block",on:{click:function(a){return t.changeValue(e.device,n,"opwm",a)}}},[i("img",{attrs:{src:a("f584")}})])])])])})),0)])])]),t._m(3)])},u=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table__top-row"},[a("div",{staticClass:"table__colum"},[t._v("№ бл.")]),a("div",{staticClass:"table__colum table__colum_ri5 table__colum_flex"},[t._v(" №вых. ")]),a("div",{staticClass:"table__colum table__colum_ri"},[t._v("Состояние")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table__top-row"},[a("div",{staticClass:"table__colum table__colum_ri4"},[t._v("№ бл.")]),a("div",{staticClass:"table__colum table__colum_ri3 table__colum_flex"},[t._v(" №вых. ")]),a("div",{staticClass:"table__colum table__colum_right table__colum_ri2"},[t._v(" Ввод % ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table__top-row"},[a("div",{staticClass:"table__colum table__colum_ri4"},[t._v("№ бл.")]),a("div",{staticClass:"table__colum table__colum_ri3 table__colum_flex"},[t._v(" №вых. ")]),a("div",{staticClass:"table__colum table__colum_right table__colum_ri2"},[t._v(" Ввод % ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel__table panel__table_2"},[a("div",{staticClass:"panel__flex panel__flex_3 table"},[a("div",{staticClass:"table__name"},[t._v("Устройства")]),a("div",{staticClass:"table__table table__table_3"},[a("div",{staticClass:"table__top-row"},[a("div",{staticClass:"table__colum"},[t._v("№ бл.")]),a("div",{staticClass:"table__colum table__colum_m1 table__colum_left"},[t._v(" Наименование ")])]),a("div",{staticClass:"table__overflow1"})])])])}],v=(a("99af"),a("7db0"),a("c740"),a("4160"),a("caad"),a("d81d"),a("a434"),a("a9e3"),a("9129"),a("b64b"),a("d3b7"),a("2532"),a("3ca3"),a("159b"),a("ddb0"),a("53ca")),b=(a("96cf"),a("1da1")),f=a("1157"),p=a.n(f),m=a("bc3a"),h=a.n(m),C=a("a786"),g={data:function(){return{ext:"",devices:[],allStates:{},states:{},hasNoFloat:C["a"],activeField:{},activeFieldTimeout:null,disabled:!1}},computed:{computedStates:function(){var t=this,e=this.clone(this.allStates),a=this.clone(this.devices).sort((function(t,e){return t.addr-e.addr}));return Object.keys(e).forEach((function(i){a.forEach((function(a){i in a.state&&a.state[i].forEach((function(n,s){e[i].push({device:a.addr,index:s,value:t.hasNoFloat.includes(i)?n/100:n,label:a.label[i]&&a.label[i][s]?a.label[i][s]:s+1})}))}))})),e}},watch:{computedStates:function(t){var e=this.clone(t);if("device"in this.activeField){var a=this.activeField,i=a.device,n=a.type,s=a.index,l=e[n].findIndex((function(t){return t.device===i&&t.index===s}));e[n][l].value=this.states[n][l].value}this.states=e}},created:function(){var t={};["obin","opwm","odac"].forEach((function(e){t[e]=[]})),this.allStates=t,this.getDevList()},methods:{home:function(t,e){var a=p()(window).width();if(a<1314){var i=e.target;p()(i).next(".nav__select").addClass("nav__select_open")}else p()(".panel__table").removeClass("panel__table_active"),p()(".panel__table_".concat(t)).addClass("panel__table_active"),p()(".nav__name").removeClass("nav__btt_active"),p()(".nav__name_".concat(t)).addClass("nav__btt_active")},show_table:function(t,e){var a=e.target;p()(".nav__option").removeClass("nav__option_active"),p()(a).addClass("nav__option_active"),p()(".table__table").removeClass("table__table_active"),p()(".table__table_".concat(t)).addClass("table__table_active")},getDevList:function(){var t=this;h.a.post("/api/devlist".concat(this.ext)).then((function(e){if(e.data.devices&&Array.isArray(e.data.devices)){var a=e.data.devices.map((function(t){return t.addr}));t.devices.forEach((function(e,i){a.includes(e.addr)||t.devices.splice(i,1)}));var i=[];e.data.devices.forEach(function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(a){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=new Promise((function(e){t.getDevice(a,e)})),n.then((function(e){var i=t.devices.findIndex((function(t){return a.addr===t.addr}));i<0&&(i=t.devices.length,t.devices.push({addr:a.addr,label:{}}),t.getLabels(a)),t.$set(t.devices[i],"state",e)})),i.push(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Promise.all(i).then((function(){setTimeout((function(){t.getDevList()}),1e3)}))}}))},getDevice:function(t,e){h.a.post("/api/state".concat(this.ext),{device:t.addr}).then((function(t){"object"!==Object(v["a"])(t.data)||null===t.data?e({}):e(t.data)})).catch((function(){e({})}))},getLabels:function(t){var e=this;h.a.post("/api/get_wlist".concat(this.ext),{device:t.addr}).then((function(a){var i=a.data;h.a.post("/api/get_label".concat(e.ext),{device:t.addr}).then((function(a){var n=a.data,s={};Object.keys(n).forEach((function(t){"device"!==t&&(s[t]=n[t])}));var l=e.devices.findIndex((function(e){return e.addr===t.addr}));e.$set(e.devices[l],"label",s),e.$set(e.devices[l],"wAddresses",i)}))}))},setActiveField:function(t,e,a){var i=this;this.activeFieldTimeout&&clearTimeout(this.activeFieldTimeout),this.activeField={device:t,index:e,type:a},this.activeFieldTimeout=setTimeout((function(){i.activeField={}}),2e4)},resetActiveField:function(){this.activeFieldTimeout&&clearTimeout(this.activeFieldTimeout),this.activeField={}},changeValue:function(t,e,a,i){var n=this;if(!this.disabled){var s=this.states[a].find((function(a){return a.device===t&&a.index===e})),l=parseInt(s.value,10);if(Number.isNaN(l))this.$toasted.error("Проверьте введенные данные",{duration:3e3});else{var c={device:t,addr:e,value:100*l};this.disabled=!0,h.a.post("/api/set_".concat(a).concat(this.ext),c).then((function(){n.$toasted.success("Данные успешно сохранены",{duration:3e3})})).catch((function(){n.$toasted.error("Ошибка!",{duration:3e3})})).finally((function(){n.disabled=!1,i.target.blur()}))}}},setObin:function(t,e,a){var i=this,n={device:t,addr:e,value:+!a};this.disabled=!0,h.a.post("/api/set_obin".concat(this.ext),n).then((function(){i.$toasted.success("Данные успешно сохранены",{duration:3e3});var n=i.states.obin.findIndex((function(a){return a.device===t&&a.index===e}));i.$set(i.states.obin[n],"value",+!a)})).catch((function(){i.$toasted.error("Ошибка!",{duration:3e3})})).finally((function(){i.disabled=!1}))},clone:function(t){return JSON.parse(JSON.stringify(t))}}},x=g,y=(a("00f8"),a("2877")),w=Object(y["a"])(x,d,u,!1,null,null,null),k=w.exports,O={name:"App",components:{LeftSideBar:_["a"],HeaderComp:r["a"],Panel:k}},F=O,$=Object(y["a"])(F,c,o,!1,null,null,null),S=$.exports;i["a"].config.productionTip=!1,i["a"].use(n["a"],{defaultTrigger:"hover"}),i["a"].use(l.a,{keepOnHover:!0}),i["a"].mixin({methods:{clone:function(t){return JSON.parse(JSON.stringify(t))}}}),new i["a"]({render:function(t){return t(S)}}).$mount("#app")},d12c:function(t,e,a){},f584:function(t,e,a){t.exports=a.p+"img/confirm.7e48b09a.svg"}});